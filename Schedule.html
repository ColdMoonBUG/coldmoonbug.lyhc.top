<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¯¾ç¨‹è¡¨</title> <!-- ä¿®æ”¹ title ä¸ºæ›´é€šç”¨çš„ "è¯¾ç¨‹è¡¨" -->
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 20px;
            background-color: #f4f7f9;
            color: #333;
        }
        .header-container {
            display: flex;
            flex-direction: column; /* ä¿®æ”¹ä¸ºå‚ç›´æ’åˆ—æ ‡é¢˜å’Œæ—¥æœŸ */
            justify-content: center; /* æ°´å¹³å±…ä¸­ */
            align-items: center; /* å‚ç›´å±…ä¸­ */
            margin-bottom: 20px;
        }
        h1 {
            text-align: center;
            margin-bottom: 5px; /* æ ‡é¢˜å’Œæ—¥æœŸä¹‹é—´å¢åŠ é—´è· */
            color: #2c3e50;
        }
        #date-display { /* æ—¥æœŸæ˜¾ç¤ºå…ƒç´ æ ·å¼ */
            text-align: center;
            font-size: 1.1em;
            color: #555;
            margin-bottom: 15px; /* æ—¥æœŸå’ŒæŒ‰é’®ä¹‹é—´å¢åŠ é—´è· */
        }
        .nav-button-container { /* æŒ‰é’®å®¹å™¨ */
            display: flex;
            justify-content: center; /* æŒ‰é’®æ°´å¹³å±…ä¸­ */
            gap: 15px; /* æŒ‰é’®ä¹‹é—´é—´è· */
        }
        .nav-button {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            background-color: #3498db;
            color: white;
            cursor: pointer;
            transition: background-color 0.3s ease;
            font-size: 0.9em;
        }
        .nav-button:hover {
            background-color: #2980b9;
        }
        .section {
            margin-bottom: 20px;
            border: 1px solid #e0e0e0;
            padding: 15px;
            border-radius: 8px;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .section-title {
            font-weight: bold;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            color: #34495e;
        }
        .section-title .time{
            margin-left: 15px;
            font-size: 0.9em;
            color: #777;
        }
        .course {
            margin-bottom: 10px;
            padding: 12px;
            background-color: #f0f0f0;
            border-radius: 6px;
            display: flex;
            flex-direction: column;
        }
        .no-course {
            color: #777;
            font-style: italic;
        }
        .course-name{
            font-size: 1.2em;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }
        .teacher, .classroom, .other-info{
            margin-left: 0;
            font-size: 0.95em;
            color: #555;
        }
        .classroom {
            font-weight: bold;
            color: #e74c3c;
        }
        #schedule-container p {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="header-container">
        <h1>è¯¾ç¨‹è¡¨</h1> <!-- ä¿®æ”¹æ ‡é¢˜ä¸ºæ›´é€šç”¨çš„ "è¯¾ç¨‹è¡¨" -->
        <p id="date-display"></p> <!-- æ·»åŠ æ—¥æœŸæ˜¾ç¤ºå…ƒç´  -->
    </div>
    <div class="nav-button-container"> <!-- æŒ‰é’®å®¹å™¨ -->
        <button id="yesterdayBtn" class="nav-button">æ˜¨å¤©è¯¾è¡¨</button>
        <button id="tomorrowBtn" class="nav-button">æ˜å¤©è¯¾è¡¨</button>
    </div>

    <div id="schedule-container">
        <!-- è¯¾ç¨‹ä¿¡æ¯å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
    </div>

    <script>
        const sectionTimes = {
            "ç¬¬ä¸€å¤§èŠ‚": "8:30 - 10:00",
            "ç¬¬äºŒå¤§èŠ‚": "10:20 - 11:50",
            "ç¬¬ä¸‰å¤§èŠ‚": "14:20 - 15:50",
            "ç¬¬å››å¤§èŠ‚": "16:00 - 17:30",
            "ç¬¬äº”å¤§èŠ‚": "17:40 - 18:40",
            "ç¬¬å…­å¤§èŠ‚": "19:00 - 20:30",
        };
        const sections = ["ç¬¬ä¸€å¤§èŠ‚","ç¬¬äºŒå¤§èŠ‚","ç¬¬ä¸‰å¤§èŠ‚","ç¬¬å››å¤§èŠ‚","ç¬¬äº”å¤§èŠ‚","ç¬¬å…­å¤§èŠ‚"];
        const yesterdayBtn = document.getElementById('yesterdayBtn');
        const tomorrowBtn = document.getElementById('tomorrowBtn');
        const dateDisplay = document.getElementById('date-display'); // è·å–æ—¥æœŸæ˜¾ç¤ºå…ƒç´ 

        let currentDate = new Date(); // ä½¿ç”¨ Date å¯¹è±¡è·Ÿè¸ªå½“å‰æ—¥æœŸ

        function formatDate(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        function getFormattedDateForDisplay(date) { // æ–°å¢å‡½æ•°ï¼Œç”¨äºæ˜¾ç¤ºæ›´å‹å¥½çš„æ—¥æœŸæ ¼å¼
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const weekdayNames = ["æ˜ŸæœŸæ—¥", "æ˜ŸæœŸä¸€", "æ˜ŸæœŸäºŒ", "æ˜ŸæœŸä¸‰", "æ˜ŸæœŸå››", "æ˜ŸæœŸäº”", "æ˜ŸæœŸå…­"];
            const weekday = weekdayNames[date.getDay()];
            return `${year}-${month}-${day} ${weekday}`; // ä¾‹å¦‚ï¼š 2025-03-05 æ˜ŸæœŸä¸‰
        }


        function fetchAndDisplaySchedule(date) {
            const formattedDate = formatDate(date); // ä½¿ç”¨ formatDate è·å– YYYY-MM-DD æ ¼å¼æ—¥æœŸ
            const apiUrl = `https://kb.lyhc.top/api/schedule?date=${formattedDate}&timestamp=${Date.now()}`;
            const scheduleContainer = document.getElementById('schedule-container');
            scheduleContainer.innerHTML = '<p>åŠ è½½è¯¾ç¨‹æ•°æ®ä¸­...</p>';

            const dayOfWeek = date.getDay(); // ä½¿ç”¨ä¼ å…¥çš„ date å‚æ•°è·å–æ˜ŸæœŸå‡ 
            if (dayOfWeek === 0 || dayOfWeek === 6) {
                scheduleContainer.innerHTML = '<p style="text-align:center; font-size:1.2em; color:#555; padding:20px;">ä¼‘æ¯å•¦ï¼Œä»Šå¤©ä¸ä¸Šè¯¾ ğŸ‰</p>';
                return;
            }

            fetch(apiUrl)
                .then(response => { /* ... (fetch æˆåŠŸå¤„ç†ä»£ç ï¼Œä¸ä¹‹å‰ç›¸åŒ) ... */
                    if (!response.ok) {
                        throw new Error(`HTTP é”™è¯¯! çŠ¶æ€: ${response.status}`);
                    }
                    return response.json();
                })
                .then(scheduleData => { /* ... (æ•°æ®å±•ç¤ºä»£ç ï¼Œä¸ä¹‹å‰ç›¸åŒ) ... */
                    scheduleContainer.innerHTML = '';
                    if (Object.keys(scheduleData).length === 0) {
                        scheduleContainer.innerHTML = '<p style="text-align:center; color:#777; padding:20px;">ä»Šå¤©æ²¡æœ‰è¯¾ç¨‹æ•°æ®ã€‚</p>';
                        return;
                    }
                    sections.forEach(sectionName => { /* ... (èŠ‚æ¬¡å’Œè¯¾ç¨‹å±•ç¤ºä»£ç ï¼Œä¸ä¹‹å‰ç›¸åŒ) ... */
                        const sectionDiv = document.createElement('div');
                        sectionDiv.classList.add('section');
                        const sectionTitle = document.createElement('div');
                        sectionTitle.classList.add('section-title');
                        sectionTitle.textContent = sectionName;
                        const timeSpan = document.createElement('span');
                        timeSpan.classList.add("time")
                        timeSpan.textContent = sectionTimes[sectionName] || '';
                        sectionTitle.appendChild(timeSpan);
                        sectionDiv.appendChild(sectionTitle);
                        if (scheduleData[sectionName] && scheduleData[sectionName].length > 0) {
                            scheduleData[sectionName].forEach(course => {
                                const courseDiv = document.createElement('div');
                                courseDiv.classList.add('course');
                                courseDiv.innerHTML = `
                                    <span class="course-name">${course.course_name}</span>
                                    <span class="classroom"><b>æ•™å®¤: <span style="color:#e74c3c;">${course.classroom}</span></b></span>
                                    <span class="teacher">æ•™å¸ˆ: ${course.teacher_name}</span>
                                    <span class="other-info">${course.other_info.join(', ')}</span>
                                `;
                                sectionDiv.appendChild(courseDiv);
                            });
                        } else {
                            const noCourseDiv = document.createElement('div');
                            noCourseDiv.classList.add('no-course');
                            noCourseDiv.textContent = 'æœ¬èŠ‚æ— è¯¾';
                            sectionDiv.appendChild(noCourseDiv);
                        }
                        scheduleContainer.appendChild(sectionDiv);
                    });
                })
                .catch(error => { /* ... (é”™è¯¯å¤„ç†ä»£ç ï¼Œä¸ä¹‹å‰ç›¸åŒ) ... */
                    console.error('è·å–è¯¾ç¨‹æ•°æ®æ—¶å‡ºé”™:', error);
                    scheduleContainer.innerHTML = '<p style="color:red;">æ— æ³•åŠ è½½è¯¾ç¨‹æ•°æ®ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–ç¨åé‡è¯•ã€‚</p>';
                });
        }

        function loadTodaySchedule() {
            currentDate = new Date(); // æ›´æ–° currentDate ä¸ºä»Šå¤©
            const formattedDisplayDate = getFormattedDateForDisplay(currentDate); // è·å–ç”¨äºæ˜¾ç¤ºçš„æ—¥æœŸæ ¼å¼
            dateDisplay.textContent = formattedDisplayDate; // è®¾ç½®æ—¥æœŸæ˜¾ç¤ºå…ƒç´ å†…å®¹
            fetchAndDisplaySchedule(currentDate); // ä¼ é€’ Date å¯¹è±¡ç»™ fetchAndDisplaySchedule
        }


        yesterdayBtn.addEventListener('click', () => {
            currentDate.setDate(currentDate.getDate() - 1); // currentDate å‡ 1 å¤©
            const formattedDisplayDate = getFormattedDateForDisplay(currentDate);
            dateDisplay.textContent = formattedDisplayDate; // æ›´æ–°æ—¥æœŸæ˜¾ç¤º
            fetchAndDisplaySchedule(currentDate); // ä¼ é€’æ›´æ–°åçš„ currentDate
        });

        tomorrowBtn.addEventListener('click', () => {
            currentDate.setDate(currentDate.getDate() + 1); // currentDate åŠ  1 å¤©
            const formattedDisplayDate = getFormattedDateForDisplay(currentDate);
            dateDisplay.textContent = formattedDisplayDate; // æ›´æ–°æ—¥æœŸæ˜¾ç¤º
            fetchAndDisplaySchedule(currentDate); // ä¼ é€’æ›´æ–°åçš„ currentDate
        });


        document.addEventListener('DOMContentLoaded', loadTodaySchedule);
    </script>
</body>
</html>